-- Generated by Oracle SQL Developer Data Modeler 21.4.1.349.1605
--   at:        2022-04-27 19:16:08 AEST
--   site:      Oracle Database 12c
--   type:      Oracle Database 12c
--student id:31460259
--student name: yepu hou
set echo on
SPOOL wc_schema_output.txt


DROP TABLE cabin CASCADE CONSTRAINTS;

DROP TABLE cruiseroute CASCADE CONSTRAINTS;

DROP TABLE manifest CASCADE CONSTRAINTS;

DROP TABLE operator CASCADE CONSTRAINTS;

DROP TABLE participant_report CASCADE CONSTRAINTS;

DROP TABLE passenger CASCADE CONSTRAINTS;

DROP TABLE passenger_payment CASCADE CONSTRAINTS;

DROP TABLE port CASCADE CONSTRAINTS;

DROP TABLE ship CASCADE CONSTRAINTS;

DROP TABLE temp CASCADE CONSTRAINTS;

DROP TABLE tour CASCADE CONSTRAINTS;

DROP TABLE worldcruise CASCADE CONSTRAINTS;

-- predefined type, no DDL - MDSYS.SDO_GEOMETRY

-- predefined type, no DDL - XMLTYPE

CREATE TABLE cabin (
    cabin_no       NUMBER(6) NOT NULL,
    cabin_class    VARCHAR2(5) NOT NULL,
    ship_code      VARCHAR2(10) NOT NULL,
    manifest_id    NUMBER(6) NOT NULL,
    cabin_id       NUMBER(6) NOT NULL,
    passenger_id   NUMBER(6) NOT NULL,
    cruise_id      NUMBER(6) NOT NULL,
    cabin_capacity NUMBER(6) NOT NULL
);

ALTER TABLE cabin
    ADD CHECK ( cabin_class IN ( 'B', 'I', 'O', 'S' ) );

COMMENT ON COLUMN cabin.cabin_no IS
    'cabin number';

COMMENT ON COLUMN cabin.cabin_class IS
    'cabin class I-interior O-ocean view B-balcony S-suite';

COMMENT ON COLUMN cabin.ship_code IS
    'ship code';

COMMENT ON COLUMN cabin.manifest_id IS
    'manifest id';

COMMENT ON COLUMN cabin.cabin_id IS
    'cabin id (surrogate pk)';

COMMENT ON COLUMN cabin.passenger_id IS
    'passenger id';

COMMENT ON COLUMN cabin.cruise_id IS
    'cruise''s id';

COMMENT ON COLUMN cabin.cabin_capacity IS
    'cabin capacity';

ALTER TABLE cabin ADD CONSTRAINT cabin_pk PRIMARY KEY ( cabin_id );

ALTER TABLE cabin
    ADD CONSTRAINT cabin_uk UNIQUE ( cabin_class,
                                     cabin_no,
                                     manifest_id,
                                     passenger_id,
                                     cruise_id,
                                     ship_code,
                                     cabin_capacity );

CREATE TABLE cruiseroute (
    cruise_arrival_time DATE NOT NULL,
    cruise_depart_time  DATE NOT NULL,
    cruise_id           NUMBER(6) NOT NULL,
    port_code           VARCHAR2(10) NOT NULL
);

COMMENT ON COLUMN cruiseroute.cruise_arrival_time IS
    'cruise arrival time';

COMMENT ON COLUMN cruiseroute.cruise_depart_time IS
    'cruise depart time';

COMMENT ON COLUMN cruiseroute.cruise_id IS
    'cruise''s id';

ALTER TABLE cruiseroute
    ADD CONSTRAINT cruiseroute_pk PRIMARY KEY ( cruise_arrival_time,
                                                cruise_depart_time,
                                                cruise_id );

CREATE TABLE manifest (
    manifest_id   NUMBER(6) NOT NULL,
    manifest_time DATE,
    passenger_id  NUMBER(6) NOT NULL,
    cruise_id     NUMBER(6) NOT NULL
);

COMMENT ON COLUMN manifest.manifest_id IS
    'manifest id';

COMMENT ON COLUMN manifest.manifest_time IS
    'manifest time and date';

COMMENT ON COLUMN manifest.passenger_id IS
    'passenger id';

COMMENT ON COLUMN manifest.cruise_id IS
    'cruise''s id';

ALTER TABLE manifest
    ADD CONSTRAINT manifest_pk PRIMARY KEY ( manifest_id,
                                             passenger_id,
                                             cruise_id );

CREATE TABLE operator (
    operator_id       NUMBER(6) NOT NULL,
    operator_name     VARCHAR2(20) NOT NULL,
    operator_ceo_name VARCHAR2(20) NOT NULL
);

COMMENT ON COLUMN operator.operator_id IS
    'operator id';

COMMENT ON COLUMN operator.operator_name IS
    'operator''s name';

COMMENT ON COLUMN operator.operator_ceo_name IS
    'operator ceo''s name';

ALTER TABLE operator ADD CONSTRAINT operator_pk PRIMARY KEY ( operator_id );

CREATE TABLE participant_report (
    date_generated DATE NOT NULL,
    tour_no        NUMBER(6) NOT NULL,
    port_code      VARCHAR2(10) NOT NULL
);

COMMENT ON COLUMN participant_report.date_generated IS
    'report generated date';

ALTER TABLE participant_report
    ADD CONSTRAINT participant_report_pk PRIMARY KEY ( date_generated,
                                                       tour_no,
                                                       port_code );

CREATE TABLE passenger (
    passenger_id        NUMBER(6) NOT NULL,
    passenger_firstname VARCHAR2(15) NOT NULL,
    passenger_lastname  VARCHAR2(15) NOT NULL,
    passenger_gender    CHAR(1) NOT NULL,
    passenger_dob       DATE NOT NULL,
    passenger_street_no VARCHAR2(50) NOT NULL,
    passenger_town      VARCHAR2(15) NOT NULL,
    passenger_postcode  NUMBER(10) NOT NULL,
    passenger_country   VARCHAR2(15) NOT NULL,
    passenger_phone_no  NUMBER(15)
);

ALTER TABLE passenger
    ADD CHECK ( passenger_gender IN ( 'M', 'O', 'W' ) );

COMMENT ON COLUMN passenger.passenger_id IS
    'passenger id';

COMMENT ON COLUMN passenger.passenger_firstname IS
    'passenger''s firstname';

COMMENT ON COLUMN passenger.passenger_lastname IS
    'passenger''s lastname';

COMMENT ON COLUMN passenger.passenger_gender IS
    'passenger''s gender M-man W-woman O-other';

COMMENT ON COLUMN passenger.passenger_dob IS
    'passenger''s dob';

COMMENT ON COLUMN passenger.passenger_street_no IS
    'passenger''s street number';

COMMENT ON COLUMN passenger.passenger_town IS
    'passenger''s town';

COMMENT ON COLUMN passenger.passenger_postcode IS
    'passenger''s postcode';

COMMENT ON COLUMN passenger.passenger_country IS
    'passenger''s country';

COMMENT ON COLUMN passenger.passenger_phone_no IS
    'passenger''s phone number';

ALTER TABLE passenger ADD CONSTRAINT passenger_pk PRIMARY KEY ( passenger_id );

CREATE TABLE passenger_payment (
    passenger_id     NUMBER(6) NOT NULL,
    spoken_lang      VARCHAR2(2) NOT NULL,
    payment_received VARCHAR2(5) NOT NULL
);

COMMENT ON COLUMN passenger_payment.passenger_id IS
    'passenger id';

COMMENT ON COLUMN passenger_payment.spoken_lang IS
    'passenger''s spoken language';

COMMENT ON COLUMN passenger_payment.payment_received IS
    'payment received';

ALTER TABLE passenger_payment ADD CONSTRAINT passenger_payment_pk PRIMARY KEY ( passenger_id );

CREATE TABLE port (
    port_code       VARCHAR2(10) NOT NULL,
    port_name       VARCHAR2(20) NOT NULL,
    country_code    VARCHAR2(2) NOT NULL,
    port_population NUMBER(10) NOT NULL,
    port_longitude  NUMBER(10) NOT NULL,
    port_latitude   NUMBER(10) NOT NULL
);

COMMENT ON COLUMN port.port_name IS
    'port''s name';

COMMENT ON COLUMN port.country_code IS
    'country code';

COMMENT ON COLUMN port.port_population IS
    'port''s population';

COMMENT ON COLUMN port.port_longitude IS
    'port''s longitude';

COMMENT ON COLUMN port.port_latitude IS
    'port''s latitude';

ALTER TABLE port ADD CONSTRAINT port_pk PRIMARY KEY ( port_code );

CREATE TABLE ship (
    ship_code               VARCHAR2(10) NOT NULL,
    ship_name               VARCHAR2(20) NOT NULL,
    ship_commissioned_date  DATE NOT NULL,
    ship_tonnage            NUMBER(10) NOT NULL,
    ship_guest_capacity     NUMBER(10) NOT NULL,
    ship_registered_country VARCHAR2(10) NOT NULL,
    operator_id             NUMBER(6) NOT NULL
);

COMMENT ON COLUMN ship.ship_code IS
    'ship code';

COMMENT ON COLUMN ship.ship_name IS
    'ship''s name';

COMMENT ON COLUMN ship.ship_commissioned_date IS
    'ship commissioned date';

COMMENT ON COLUMN ship.ship_tonnage IS
    'tonnage of ship';

COMMENT ON COLUMN ship.ship_guest_capacity IS
    'guest capacity of ship';

COMMENT ON COLUMN ship.ship_registered_country IS
    'ship Registered Country';

COMMENT ON COLUMN ship.operator_id IS
    'operator id';

ALTER TABLE ship ADD CONSTRAINT ship_pk PRIMARY KEY ( ship_code );

CREATE TABLE temp (
    port_code  VARCHAR2(10) NOT NULL,
    temp_month NUMBER(2) NOT NULL,
    temp_high  NUMBER(2) NOT NULL,
    temp_low   NUMBER(2) NOT NULL
);

COMMENT ON COLUMN temp.temp_month IS
    'month of temperature';

COMMENT ON COLUMN temp.temp_high IS
    'highest temperature';

COMMENT ON COLUMN temp.temp_low IS
    'lowest temperature ';

ALTER TABLE temp ADD CONSTRAINT temp_pk PRIMARY KEY ( temp_month,
                                                      port_code );

CREATE TABLE tour (
    port_code              VARCHAR2(10) NOT NULL,
    tour_no                NUMBER(6) NOT NULL,
    tour_name              VARCHAR2(20) NOT NULL,
    tour_description       VARCHAR2(50) NOT NULL,
    tour_hrs_required      NUMBER(2) NOT NULL,
    tour_costpp            NUMBER(6) NOT NULL,
    tour_wheelchair_access CHAR(1),
    tour_avaliability      NUMBER(5) NOT NULL,
    tour_start             VARCHAR2(10) NOT NULL
);

ALTER TABLE tour
    ADD CHECK ( tour_wheelchair_access IN ( 'N', 'Y' ) );

COMMENT ON COLUMN tour.tour_name IS
    'name of tour';

COMMENT ON COLUMN tour.tour_description IS
    'description of tour';

COMMENT ON COLUMN tour.tour_hrs_required IS
    'tour hours required';

COMMENT ON COLUMN tour.tour_costpp IS
    'tour cost per person';

COMMENT ON COLUMN tour.tour_wheelchair_access IS
    'tour wheelchair access Y-yes N-no';

COMMENT ON COLUMN tour.tour_avaliability IS
    'tour avaliability slot left';

COMMENT ON COLUMN tour.tour_start IS
    'tour start';

ALTER TABLE tour ADD CONSTRAINT tour_pk PRIMARY KEY ( tour_no,
                                                      port_code );

CREATE TABLE worldcruise (
    cruise_id          NUMBER(6) NOT NULL,
    cruise_description VARCHAR2(50) NOT NULL,
    cruise_name        VARCHAR2(20) NOT NULL,
    port_code          VARCHAR2(10),
    ship_code          VARCHAR2(10) NOT NULL
);

COMMENT ON COLUMN worldcruise.cruise_id IS
    'cruise''s id';

COMMENT ON COLUMN worldcruise.cruise_description IS
    'cruise description';

COMMENT ON COLUMN worldcruise.cruise_name IS
    'cruise''s name';

COMMENT ON COLUMN worldcruise.ship_code IS
    'ship code';

ALTER TABLE worldcruise ADD CONSTRAINT worldcruise_pk PRIMARY KEY ( cruise_id );

ALTER TABLE cabin
    ADD CONSTRAINT manifest_cabin FOREIGN KEY ( manifest_id,
                                                passenger_id,
                                                cruise_id )
        REFERENCES manifest ( manifest_id,
                              passenger_id,
                              cruise_id );

ALTER TABLE manifest
    ADD CONSTRAINT manifest_passenger FOREIGN KEY ( passenger_id )
        REFERENCES passenger ( passenger_id );

ALTER TABLE ship
    ADD CONSTRAINT operator_ship FOREIGN KEY ( operator_id )
        REFERENCES operator ( operator_id );

ALTER TABLE passenger_payment
    ADD CONSTRAINT passenger_passengerpayment FOREIGN KEY ( passenger_id )
        REFERENCES passenger ( passenger_id );

ALTER TABLE temp
    ADD CONSTRAINT port_temp FOREIGN KEY ( port_code )
        REFERENCES port ( port_code );

ALTER TABLE tour
    ADD CONSTRAINT port_tour FOREIGN KEY ( port_code )
        REFERENCES port ( port_code );

ALTER TABLE cruiseroute
    ADD CONSTRAINT relation_15 FOREIGN KEY ( port_code )
        REFERENCES port ( port_code );

ALTER TABLE worldcruise
    ADD CONSTRAINT relation_7 FOREIGN KEY ( port_code )
        REFERENCES port ( port_code );

ALTER TABLE cabin
    ADD CONSTRAINT ship_cabin FOREIGN KEY ( ship_code )
        REFERENCES ship ( ship_code );

ALTER TABLE worldcruise
    ADD CONSTRAINT ship_worldcruise FOREIGN KEY ( ship_code )
        REFERENCES ship ( ship_code );

ALTER TABLE participant_report
    ADD CONSTRAINT tour_participantreport FOREIGN KEY ( tour_no,
                                                        port_code )
        REFERENCES tour ( tour_no,
                          port_code );

ALTER TABLE cruiseroute
    ADD CONSTRAINT worldcruise_cruiseroute FOREIGN KEY ( cruise_id )
        REFERENCES worldcruise ( cruise_id );

ALTER TABLE manifest
    ADD CONSTRAINT worldcruise_manifest FOREIGN KEY ( cruise_id )
        REFERENCES worldcruise ( cruise_id );


SPOOL off
set echo off
-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            12
-- CREATE INDEX                             0
-- ALTER TABLE                             29
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- TSDP POLICY                              0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0